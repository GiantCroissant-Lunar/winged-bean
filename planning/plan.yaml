# WingedBean Project Plan
# This file serves as the single source of truth for task decomposition and dependencies.
# It's consumed by the OWL planner, validated in CI, and used to generate GitHub issues.

meta:
  project: winged-bean
  description: Cross-platform terminal GUI framework with plugin architecture
  rules:
    max_touch_files_per_task: 15
    prefer_parallel_leaves: true
    test_coverage_threshold: 80
  routing:
    # Size (effort) guidance (tool-agnostic)
    size:XS: "≤1 hr"
    size:S: "≈1–3 hrs"
    size:M: "≈0.5–1 day"
    size:L: "≈1–2 days"
    size:XL: ">2 days"
    domain:frontend: "UI, UX, rendering and input"
    domain:backend: "Services, APIs, frameworks, data and logic"
    domain:infra: "CI/CD, infra-as-code, deployment"

tasks:
  # Example task structure - replace with actual project tasks
  - id: RFC-001
    desc: "Draft terminal emulation RFC with acceptance criteria"
    needs: []
    labels: [domain:docs, size:S]
    estimate: 2h
    files: [docs/rfcs/]

  - id: PTY-SERVICE
    desc: "Implement PTY service abstraction layer"
    needs: [RFC-001]
    labels: [size:M, domain:backend, parallel:true]
    estimate: 8h
    files: [development/nodejs/pty-service/]
    acceptance_criteria:
      - PTY creation and destruction
      - Input/output streaming
      - Process lifecycle management
      - Unit tests with >80% coverage

  - id: TERM-GUI-SHELL
    desc: "Create Terminal.Gui shell application"
    needs: [RFC-001]
    labels: [size:L, domain:frontend, parallel:true]
    estimate: 12h
    files: [development/dotnet/console/]
    acceptance_criteria:
      - Window layout and rendering
      - Keyboard input handling
      - Theme support
      - Basic navigation

  - id: PTY-INTEGRATION
    desc: "Wire PTY service to Terminal.Gui shell"
    needs: [PTY-SERVICE, TERM-GUI-SHELL]
    labels: [size:M, domain:integration, test:e2e]
    estimate: 6h
    files: [development/dotnet/console/, development/nodejs/pty-service/]
    acceptance_criteria:
      - PTY output renders in Terminal.Gui
      - Keyboard input flows to PTY
      - E2E test with real shell session
      - Error handling and recovery

  - id: PLUGIN-API
    desc: "Design and implement plugin API interface"
    needs: [RFC-001]
    labels: [size:L, domain:backend, architecture]
    estimate: 10h
    files: [development/dotnet/framework/]
    acceptance_criteria:
      - IPlugin interface definition
      - Plugin lifecycle (init/dispose)
      - Event subscription model
      - API documentation

  - id: UNITY-PLUGIN
    desc: "Create Unity integration plugin"
    needs: [PLUGIN-API, PTY-INTEGRATION]
    labels: [size:L, domain:unity, parallel:true]
    estimate: 16h
    files: [development/unity/]
    acceptance_criteria:
      - Unity editor integration
      - Scene view terminal window
      - Play mode support
      - Sample project

  - id: DEPLOYMENT-SETUP
    desc: "Set up CI/CD pipeline and deployment infrastructure"
    needs: [PTY-INTEGRATION]
    labels: [size:M, domain:infra, deployment]
    estimate: 8h
    files: [infra/terraform/, .github/workflows/]
    acceptance_criteria:
      - Multi-platform builds (Windows/macOS/Linux)
      - Automated testing in CI
      - Release artifact generation
      - Deployment to staging

# DAG edges are derived from task.needs relationships
# CI will validate this forms a proper DAG (no cycles)
