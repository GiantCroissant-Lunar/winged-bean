# build/Taskfile.yml
version: '3'

vars:
  VERSION:
    sh: dotnet gitversion /showvariable SemVer
  FULL_VERSION:
    sh: dotnet gitversion /showvariable FullSemVer
  ARTIFACT_DIR: _artifacts/v{{.VERSION}}

tasks:
  version:
    desc: Show current GitVersion
    cmds:
      - 'echo "Version: {{.VERSION}}"'
      - 'echo "Full Version: {{.FULL_VERSION}}"'

  init-dirs:
    desc: Initialize build artifact directories
    cmds:
      - mkdir -p {{.ARTIFACT_DIR}}/dotnet/{bin,recordings,logs}
      - mkdir -p {{.ARTIFACT_DIR}}/web/{dist,recordings,logs}
      - mkdir -p {{.ARTIFACT_DIR}}/pty/{dist,logs}
      - mkdir -p {{.ARTIFACT_DIR}}/_logs

  clean:
    desc: Clean build artifacts and Task cache
    cmds:
      - rm -rf _artifacts/* .task/
